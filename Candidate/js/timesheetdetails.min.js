$(document).ready(function () {
    $(function () {
        //$('.uiinputtime').timepicker({
        //    convention: 12,
        //    format12: '{h:2.d}:{m:02.d} {suffix:s}',
        //    trigger: "click"
        //});
        $('#dialog').dialog({
            autoOpen: false,
            modal: true,
            width: 600,
            buttons: {
                "I Agree": function () {
                    $(this).dialog("close");
                    submitforapproval();
                },
                "Cancel": function () {
                    $(this).dialog("close");
                }
            }
        });
        $("table.stripes tr:nth-child(odd)").addClass("odd");
        $("ul.stripes li:nth-child(odd)").addClass("oddDept");
	    $("form.stripes div:nth-child(odd)").addClass("oddLite");
    	
	    $("table.stripesInvert tr:nth-child(even)").addClass("odd");
	    $("form.stripesInvert div:nth-child(even)").addClass("oddLite");
    	
	    $(".stripesLight tr:nth-child(odd)").addClass("row-estimate");
	    
        $('#submit_link').click(function () {
            if ($(this).hasClass('disabled')) {
                showerrordialog("Timeheet cannot be submitted", "Correct the errors and then re-calculate the hours");
                return false;
            } else {
                $('#dialog').dialog('open');
                return false;
            }
        });
        
        $('#save_link').click(function () {
            if ($(this).hasClass('disabled')) {
                showerrordialog("Timesheet cannot be saved", "Correct the errors and then re-calculate the hours");
                return false;
            } else {
                saveandexit();
                return false;
            }
        });
        $('.uibutton').hover(function () {
            $(this).addClass('ui-state-hover');
        }, function () {
            $(this).removeClass('ui-state-hover');
        });
        $('#print_link').click(function () {
            window.print();
            return false;
        });
        $('#hours_link').click(function () {
            TotalWeekHours();
        });
        
        //Copy Hours
        $('#2dayCopyHours').hide()
        function copyHours() {

            
            var mIndex = $(this).parents('tr').index();

            var strControlID = $(this).attr('id');
            if (strControlID.indexOf("day") > 0) {
                var strDay = strControlID.substr(0, strControlID.indexOf("day") + 3);
                updatedayicon(strDay, '', 'Click Calculate Hours to check the time');
                cansubmittimesheet(false, '');
            }
            $(this).parents('tr').find('td').each(function(){
                if( jQuery(this).find('input').length > 0 ){
                    jQuery(this).find('input').val( jQuery('.timesheet-table tr:nth-child('+(mIndex)+') td:nth-child('+( jQuery(this).index() + 1   )+') input').val());	
              }
            });
            }

        jQuery('.CopyHours').click(function(){
            
            var mIndex = jQuery(this).parents('tr').index();

            var strControlID = $(this).attr('id');
            if (strControlID.indexOf("day") > 0) {
                var strDay = strControlID.substr(0, strControlID.indexOf("day") + 3);
                updatedayicon(strDay, '', 'Click Calculate Hours to check the time');
                cansubmittimesheet(false, '');
            }
            jQuery(this).parents('tr').find('td').each(function(){
                if( jQuery(this).find('input').length > 0 ){
                    jQuery(this).find('input').val( jQuery('.timesheet-table tr:nth-child('+(mIndex)+') td:nth-child('+( jQuery(this).index() + 1   )+') input').val());	
              }
            });
        });
        
        $('#theform :input').change(function () {
            var strControlID = $(this).attr('id');
            if (strControlID.indexOf("day") > 0) {
                var strDay = strControlID.substr(0, strControlID.indexOf("day") + 3);
                updatedayicon(strDay, '', 'Click Calculate Hours to check the time');
                cansubmittimesheet(false, '');
            }
        });
        var leaveday 
        $('.uidayofleavebutton').click(function () {
            SelectLeaveType($(this).attr('id'));
            var part = $(this).attr('id');
            leaveday = part[0];
        });
        $('#leavedialog').dialog({
            autoOpen: false,
            modal: true,
            width: 300,
            buttons: {
                "Cancel": function () {
                    $(this).dialog("close");
                }
            }
        });

        $('.uileavetypebutton').click(function () {


            if ($(this).attr('id') == 'Annualleavetype') {
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("hidden", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").unbind("click");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("disabled", "true");  
                console.log(leaveday)
                updateleave('Annual', 'Annual Leave',leaveday);
            } else if ($(this).attr('id') == 'Bereavementleavetype') {
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("hidden", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("disabled", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").unbind("click");

                updateleave('Bereavement', 'Bereavement Leave', leaveday);
            } else if ($(this).attr('id') == 'Sickleavetype') {
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("hidden", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("disabled", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").unbind("click");

                updateleave('Sick', 'Sick Leave', leaveday);
            } else if ($(this).attr('id') == 'Statleavetype') {
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("hidden", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("disabled", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").unbind("click");

                updateleave('Stat', 'Stat Day in Lieu', leaveday);
            } else if ($(this).attr('id') == 'PublicHolWorkedleavetype') {
                $('input[idnotserver="' + leavecntl).html('Pub Holiday - Worked');
                $('input[idnotserver="' + leavevalue).attr('value', 'Public Hol - W');
                $('input[idnotserver="' + leaveday + 'dayStartTime"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayBreakStart"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayBreakFinish"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").removeAttr("hidden");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").removeAttr("disabled");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").click(copyHours);

            } else if ($(this).attr('id') == 'PublicHolNotWorkedleavetype') {
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("hidden", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").attr("disabled", "true");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").unbind("click");

                updateleave('Public Hol - NW', 'Pub Holiday - Not Worked', leaveday);
            } else {
                $('#' + leavecntl).html('Enter Leave');
                $('#' + leavecntl).parent().find("input").removeAttr('value');
                $('input[idnotserver="' + leaveday + 'dayStartTime"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayBreakStart"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayBreakFinish"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').removeAttr('disabled');
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").removeAttr("hidden");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").removeAttr("disabled");
                $('input[idnotserver="' + leaveday + 'dayFinishTime"]').parent().parent().parent().find(".timeCol3 a").click(copyHours);
                console.log(leavevalue)
            }
            $('#leavedialog').dialog("close");
        });
    });
});

$(document).ready( function(){

    $('.addnewHSBtn').click( function(event){
        event.stopPropagation();
        $('.HSOptions').toggle();
		$("#hiddenFields").hide();
    });
	
    $(document).click( function(){
        $('.HSOptions').hide();
    });
	
	$(".HSOptions").click(function(e){
    e.stopPropagation();
});
});